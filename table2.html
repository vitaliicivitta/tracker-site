<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢—Ä–µ–∫–µ—Ä —î–≤—Ä–æ—ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ–π–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–µ—Å—É - –†–æ–∑–¥—ñ–ª–∏ 23/24</title>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Roboto+Slab:wght@400;600&display=swap" rel="stylesheet">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Roboto', 'Segoe UI', Ubuntu, sans-serif;
            background-color: #f5f7fa;
            color: #333;
        }
        
        /* –®–∞–ø–∫–∞ */
        header {
            background: linear-gradient(135deg, #005BBB, #7B68EE);
            color: white;
            padding: 40px 0;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        header h1 {
            font-family: 'Roboto Slab', serif;
            font-size: 28px;
            margin-bottom: 10px;
        }
        
        header p {
            font-size: 16px;
            opacity: 0.9;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* –ó–∞–≥–∞–ª—å–Ω–∏–π —Ç—Ä–µ–∫–µ—Ä */
        .tracker-section {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
            margin: 20px 0;
            padding: 30px;
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .section-header h2 {
            font-family: 'Roboto Slab', serif;
            font-size: 24px;
            color: #333;
        }
        
        .refresh-button {
            padding: 10px 20px;
            background: linear-gradient(135deg, #FFD700, #FF8C00);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .refresh-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255,140,0,0.3);
        }
        
        .status-info {
            background: #BFD6EE;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            border-left: 4px solid #005BBB;
        }
        
        .status-info p {
            margin: 5px 0;
            font-size: 14px;
            line-height: 1.6;
        }
        
        /* –°—Ç–∏–ª—ñ –¥–ª—è —Ä–æ–∑–¥—ñ–ª—ñ–≤ */
        .chapter-tracker {
            margin-bottom: 30px;
        }
        
        .chapter-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding: 15px;
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-radius: 8px;
        }
        
        .chapter-title {
            font-size: 18px;
            font-weight: 600;
            color: #333;
        }
        
        .chapter-total {
            font-size: 14px;
            color: #666;
            background: white;
            padding: 5px 15px;
            border-radius: 20px;
            border: 1px solid #e0e0e0;
        }
        
        /* –°—Ç–∞—Ç—É—Å-–±–∞—Ä */
        .status-bar {
            display: flex;
            height: 40px;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            margin-bottom: 15px;
        }
        
        .status-segment {
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.5s ease;
            position: relative;
            overflow: hidden;
        }
        
        .status-segment span {
            position: relative;
            z-index: 2;
        }
        
        /* –ö–æ–ª—å–æ—Ä–∏ —Å—Ç–∞—Ç—É—Å—ñ–≤ */
        .status-completed { background-color: #28a745; }
        .status-partial { background-color: #ffc107; }
        .status-inprogress { background-color: #17a2b8; }
        .status-notcompleted { background-color: #dc3545; }
        .status-notstarted { background-color: #6c757d; }
        
        /* –õ–µ–≥–µ–Ω–¥–∞ */
        .status-legend {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
        }
        
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
        }
        
        /* –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #f8f9fa, #ffffff);
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid #e0e0e0;
            transition: all 0.3s;
        }
        
        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        .stat-value {
            font-size: 32px;
            font-weight: bold;
            background: linear-gradient(135deg, #005BBB, #7B68EE);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            display: block;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 14px;
            color: #666;
        }
        
        /* –ù–æ–≤–∏–π –±–ª–æ–∫ –∑ –∑–∞—Ö–æ–¥–∞–º–∏ */
        .measures-section {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
            margin: 20px 0;
            padding: 30px;
        }
        
        .measures-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .chapter-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .chapter-button {
            padding: 12px 24px;
            background: linear-gradient(135deg, #005BBB, #0047a3);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 15px;
            font-weight: 500;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .chapter-button:hover {
            background: linear-gradient(135deg, #0047a3, #003d8a);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,91,187,0.3);
        }
        
        .chapter-button.active {
            background: linear-gradient(135deg, #FFD700, #FF8C00);
        }
        
        .chapter-button::after {
            content: '‚ñº';
            font-size: 12px;
            transition: transform 0.3s;
        }
        
        .chapter-button.active::after {
            transform: rotate(180deg);
        }
        
        /* –§—ñ–ª—å—Ç—Ä —Å—Ç–∞—Ç—É—Å—ñ–≤ */
        .status-filter-wrapper {
            position: relative;
        }
        
        .status-filter-button {
            padding: 10px 20px;
            background: white;
            border: 2px solid #005BBB;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
            min-width: 200px;
            justify-content: space-between;
        }
        
        .status-filter-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            background: white;
            border: 2px solid #005BBB;
            border-radius: 8px;
            margin-top: 5px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            display: none;
            z-index: 1000;
            min-width: 200px;
        }
        
        .status-filter-dropdown.show {
            display: block;
        }
        
        .filter-option {
            padding: 10px 15px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: background 0.2s;
        }
        
        .filter-option:hover {
            background: #f0f7ff;
        }
        
        .filter-option input[type="checkbox"] {
            cursor: pointer;
        }
        
        /* –¢–∞–±–ª–∏—Ü—è –∑–∞—Ö–æ–¥—ñ–≤ */
        .measures-table-wrapper {
            overflow-x: auto;
            margin-top: 20px;
        }
        
        .measures-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
        }
        
        .measures-table th {
            background: linear-gradient(135deg, #005BBB, #0047a3);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .measures-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #e0e0e0;
            vertical-align: top;
        }
        
        .measures-table tr:hover {
            background: #f8f9fa;
        }
        
        /* –ö–æ–ª–æ–Ω–∫–∏ */
        .col-number { width: 60px; text-align: center; font-weight: 600; }
        .col-sr { width: 20%; background: #f8f9fa; font-weight: 500; }
        .col-measure { width: 50%; }
        .col-deadline { width: 15%; text-align: center; }
        .col-status { width: 15%; text-align: center; }
        
        /* –Ü–∫–æ–Ω–∫–∏ —Å—Ç–∞—Ç—É—Å—ñ–≤ */
        .status-icon {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            margin-bottom: 5px;
        }
        
        .status-icon.completed { background: #28a745; color: white; }
        .status-icon.partial { background: #ffc107; color: white; }
        .status-icon.inprogress { background: #17a2b8; color: white; }
        .status-icon.notcompleted { background: #dc3545; color: white; }
        .status-icon.notstarted { background: #6c757d; color: white; }
        
        /* –ó–∞–≥–æ–ª–æ–≤–∫–∏ —Ä–æ–∑–¥—ñ–ª—ñ–≤ –≤ —Ç–∞–±–ª–∏—Ü—ñ */
        .section-row-1 {
            background: linear-gradient(135deg, #005BBB, #0047a3);
            color: white;
            font-weight: 600;
            font-size: 16px;
        }
        
        .section-row-2 {
            background: linear-gradient(135deg, #4a90e2, #357abd);
            color: white;
            font-weight: 500;
            font-size: 15px;
        }
        
        .section-row-3 {
            background: linear-gradient(135deg, #7fb3e8, #5a9bd4);
            color: white;
            font-weight: 500;
            font-size: 14px;
        }
        
        .section-row td {
            padding: 15px 20px !important;
        }
        
        /* –ö–æ–¥ –∑–∞—Ö–æ–¥—É */
        .measure-code {
            font-weight: 600;
            color: #005BBB;
            margin-right: 8px;
        }
        
        /* –ê–Ω—ñ–º–∞—Ü—ñ—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #005BBB;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* –ê–¥–∞–ø—Ç–∏–≤–Ω—ñ—Å—Ç—å */
        @media (max-width: 768px) {
            .measures-controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .chapter-buttons {
                flex-direction: column;
                width: 100%;
            }
            
            .chapter-button {
                width: 100%;
                justify-content: center;
            }
            
            .status-filter-wrapper {
                width: 100%;
            }
            
            .status-filter-button {
                width: 100%;
            }
            
            .measures-table {
                font-size: 12px;
            }
            
            .measures-table th,
            .measures-table td {
                padding: 8px;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É —î–≤—Ä–æ—ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ–π–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–µ—Å—É –£–∫—Ä–∞—ó–Ω–∏</h1>
        <p>–†–æ–∑–¥—ñ–ª–∏ 23 —Ç–∞ 24: –í–µ—Ä—Ö–æ–≤–µ–Ω—Å—Ç–≤–æ –ø—Ä–∞–≤–∞ | –ü—Ä–∞–≤–æ—Å—É–¥–¥—è, —Å–≤–æ–±–æ–¥–∞ —Ç–∞ –±–µ–∑–ø–µ–∫–∞</p>
    </header>
    
    <div class="container">
        <!-- –ó–∞–≥–∞–ª—å–Ω–∏–π —Ç—Ä–µ–∫–µ—Ä –ø—Ä–æ–≥—Ä–µ—Å—É -->
        <div class="tracker-section">
            <div class="section-header">
                <h2>–¢—Ä–µ–∫–µ—Ä –ø—Ä–æ–≥—Ä–µ—Å—É –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∑–∞—Ö–æ–¥—ñ–≤</h2>
                <button class="refresh-button" onclick="loadAllData()">
                    <span id="refresh-icon">üîÑ</span>
                    <span>–û–Ω–æ–≤–∏—Ç–∏ –¥–∞–Ω—ñ</span>
                </button>
            </div>
            
            <div class="status-info">
                <p><strong>–ü–æ—Ç–æ—á–Ω–∏–π —Å—Ç–∞–Ω:</strong> <span id="current-date">–ì—Ä—É–¥–µ–Ω—å 2024</span></p>
                <p><strong>–û—Å—Ç–∞–Ω–Ω—î –æ–Ω–æ–≤–ª–µ–Ω–Ω—è:</strong> <span id="last-update">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</span></p>
            </div>
            
            <!-- –õ–µ–≥–µ–Ω–¥–∞ —Å—Ç–∞—Ç—É—Å—ñ–≤ -->
            <div class="status-legend">
                <div class="legend-item">
                    <div class="legend-color status-completed"></div>
                    <span>–í–∏–∫–æ–Ω–∞–Ω–æ</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color status-partial"></div>
                    <span>–í–∏–∫–æ–Ω–∞–Ω–æ —á–∞—Å—Ç–∫–æ–≤–æ</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color status-inprogress"></div>
                    <span>–í–∏–∫–æ–Ω—É—î—Ç—å—Å—è</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color status-notcompleted"></div>
                    <span>–ù–µ –≤–∏–∫–æ–Ω–∞–Ω–æ</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color status-notstarted"></div>
                    <span>–ù–µ —Ä–æ–∑–ø–æ—á–∞—Ç–æ</span>
                </div>
            </div>
            
            <!-- –†–æ–∑–¥—ñ–ª 23 -->
            <div class="chapter-tracker" id="chapter23">
                <div class="chapter-header">
                    <h3 class="chapter-title">–†–æ–∑–¥—ñ–ª 23: –í–µ—Ä—Ö–æ–≤–µ–Ω—Å—Ç–≤–æ –ø—Ä–∞–≤–∞ —Ç–∞ –æ—Å–Ω–æ–≤–æ–ø–æ–ª–æ–∂–Ω—ñ –ø—Ä–∞–≤–∞ —Ç–∞ —Å–≤–æ–±–æ–¥–∏</h3>
                    <span class="chapter-total" id="chapter23-total">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</span>
                </div>
                <div class="status-bar" id="status-bar-23">
                    <div class="loading"></div>
                </div>
            </div>
            
            <!-- –†–æ–∑–¥—ñ–ª 24 -->
            <div class="chapter-tracker" id="chapter24">
                <div class="chapter-header">
                    <h3 class="chapter-title">–†–æ–∑–¥—ñ–ª 24: –ü—Ä–∞–≤–æ—Å—É–¥–¥—è, —Å–≤–æ–±–æ–¥–∞ —Ç–∞ –±–µ–∑–ø–µ–∫–∞</h3>
                    <span class="chapter-total" id="chapter24-total">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</span>
                </div>
                <div class="status-bar" id="status-bar-24">
                    <div class="loading"></div>
                </div>
            </div>
            
            <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
            <div class="stats-grid">
                <div class="stat-card">
                    <span class="stat-value" id="total-measures">0</span>
                    <div class="stat-label">–ó–∞–≥–∞–ª—å–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∑–∞—Ö–æ–¥—ñ–≤</div>
                </div>
                <div class="stat-card">
                    <span class="stat-value" id="completed-measures">0</span>
                    <div class="stat-label">–í–∏–∫–æ–Ω–∞–Ω–æ –∑–∞—Ö–æ–¥—ñ–≤</div>
                </div>
                <div class="stat-card">
                    <span class="stat-value" id="progress-percentage">0%</span>
                    <div class="stat-label">–ó–∞–≥–∞–ª—å–Ω–∏–π –ø—Ä–æ–≥—Ä–µ—Å</div>
                </div>
                <div class="stat-card">
                    <span class="stat-value" id="active-measures">0</span>
                    <div class="stat-label">–ó–∞—Ö–æ–¥—ñ–≤ –≤ —Ä–æ–±–æ—Ç—ñ</div>
                </div>
            </div>
        </div>
        
        <!-- –ù–æ–≤–∏–π –±–ª–æ–∫ –∑ –¥–µ—Ç–∞–ª—å–Ω–∏–º–∏ –∑–∞—Ö–æ–¥–∞–º–∏ -->
        <div class="measures-section">
            <div class="section-header">
                <h2>–î–µ—Ç–∞–ª—å–Ω–∏–π –ø–µ—Ä–µ–ª—ñ–∫ –∑–∞—Ö–æ–¥—ñ–≤</h2>
            </div>
            
            <div class="measures-controls">
                <div class="chapter-buttons">
                    <button class="chapter-button" id="btn-chapter-23" onclick="toggleChapter(23)">
                        23 —Ä–æ–∑–¥—ñ–ª ¬´–í–µ—Ä—Ö–æ–≤–µ–Ω—Å—Ç–≤–æ –ø—Ä–∞–≤–∞ —Ç–∞ –æ—Å–Ω–æ–≤–æ–ø–æ–ª–æ–∂–Ω—ñ –ø—Ä–∞–≤–∞ —Ç–∞ —Å–≤–æ–±–æ–¥–∏¬ª
                    </button>
                    <button class="chapter-button" id="btn-chapter-24" onclick="toggleChapter(24)">
                        24 —Ä–æ–∑–¥—ñ–ª ¬´–ü—Ä–∞–≤–æ—Å—É–¥–¥—è, —Å–≤–æ–±–æ–¥–∞, –±–µ–∑–ø–µ–∫–∞¬ª
                    </button>
                </div>
                
                <div class="status-filter-wrapper">
                    <button class="status-filter-button" onclick="toggleStatusFilter()">
                        <span id="filter-text">–í—Å—ñ —Å—Ç–∞—Ç—É—Å–∏</span>
                        <span>‚ñº</span>
                    </button>
                    <div class="status-filter-dropdown" id="status-filter-dropdown">
                        <div class="filter-option">
                            <input type="checkbox" id="filter-all" checked onchange="toggleAllStatuses()">
                            <label for="filter-all">–í—Å—ñ —Å—Ç–∞—Ç—É—Å–∏</label>
                        </div>
                        <div class="filter-option">
                            <input type="checkbox" id="filter-completed" checked onchange="updateFilter()">
                            <label for="filter-completed">–í–∏–∫–æ–Ω–∞–Ω–æ</label>
                        </div>
                        <div class="filter-option">
                            <input type="checkbox" id="filter-partial" checked onchange="updateFilter()">
                            <label for="filter-partial">–í–∏–∫–æ–Ω–∞–Ω–æ —á–∞—Å—Ç–∫–æ–≤–æ</label>
                        </div>
                        <div class="filter-option">
                            <input type="checkbox" id="filter-inprogress" checked onchange="updateFilter()">
                            <label for="filter-inprogress">–í–∏–∫–æ–Ω—É—î—Ç—å—Å—è</label>
                        </div>
                        <div class="filter-option">
                            <input type="checkbox" id="filter-notcompleted" checked onchange="updateFilter()">
                            <label for="filter-notcompleted">–ù–µ –≤–∏–∫–æ–Ω–∞–Ω–æ</label>
                        </div>
                        <div class="filter-option">
                            <input type="checkbox" id="filter-notstarted" checked onchange="updateFilter()">
                            <label for="filter-notstarted">–ù–µ —Ä–æ–∑–ø–æ—á–∞—Ç–æ</label>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- –¢–∞–±–ª–∏—Ü—ñ –¥–ª—è —Ä–æ–∑–¥—ñ–ª—ñ–≤ -->
            <div id="table-chapter-23" class="measures-table-wrapper" style="display: none;">
                <table class="measures-table">
                    <thead>
                        <tr>
                            <th class="col-number">‚Ññ</th>
                            <th class="col-sr">–°–†</th>
                            <th class="col-measure">–ó–∞—Ö—ñ–¥</th>
                            <th class="col-deadline">–¢–µ—Ä–º—ñ–Ω</th>
                            <th class="col-status">–°—Ç–∞—Ç—É—Å</th>
                        </tr>
                    </thead>
                    <tbody id="tbody-chapter-23">
                        <!-- –î–∏–Ω–∞–º—ñ—á–Ω–æ –∑–∞–ø–æ–≤–Ω—é—î—Ç—å—Å—è -->
                    </tbody>
                </table>
            </div>
            
            <div id="table-chapter-24" class="measures-table-wrapper" style="display: none;">
                <table class="measures-table">
                    <thead>
                        <tr>
                            <th class="col-number">‚Ññ</th>
                            <th class="col-sr">–°–†</th>
                            <th class="col-measure">–ó–∞—Ö—ñ–¥</th>
                            <th class="col-deadline">–¢–µ—Ä–º—ñ–Ω</th>
                            <th class="col-status">–°—Ç–∞—Ç—É—Å</th>
                        </tr>
                    </thead>
                    <tbody id="tbody-chapter-24">
                        <!-- –î–∏–Ω–∞–º—ñ—á–Ω–æ –∑–∞–ø–æ–≤–Ω—é—î—Ç—å—Å—è -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        // –ì–ª–æ–±–∞–ª—å–Ω—ñ –∑–º—ñ–Ω–Ω—ñ
        const statusData = {
            chapter23: {
                total: 0,
                statuses: {
                    completed: 0,
                    partial: 0,
                    inprogress: 0,
                    notcompleted: 0,
                    notstarted: 0
                }
            },
            chapter24: {
                total: 0,
                statuses: {
                    completed: 0,
                    partial: 0,
                    inprogress: 0,
                    notcompleted: 0,
                    notstarted: 0
                }
            }
        };
        
        let chapter23Data = [];
        let chapter24Data = [];
        let activeChapters = [];
        let activeFilters = ['completed', 'partial', 'inprogress', 'notcompleted', 'notstarted'];
        
        // –§—É–Ω–∫—Ü—ñ—è –ø–∞—Ä—Å–∏–Ω–≥—É CSV
        function parseCSV(text) {
            const rows = text.split('\n').filter(row => row.trim());
            const headers = rows[0].split(',').map(h => h.trim().replace(/"/g, ''));
            const data = [];
            
            for (let i = 1; i < rows.length; i++) {
                const values = parseCSVRow(rows[i]);
                const row = {};
                headers.forEach((header, index) => {
                    row[header] = values[index]?.trim().replace(/"/g, '') || '';
                });
                data.push(row);
            }
            
            return data;
        }
        
        function parseCSVRow(row) {
            const result = [];
            let current = '';
            let inQuotes = false;
            
            for (let i = 0; i < row.length; i++) {
                const char = row[i];
                
                if (char === '"') {
                    inQuotes = !inQuotes;
                } else if (char === ',' && !inQuotes) {
                    result.push(current);
                    current = '';
                } else {
                    current += char;
                }
            }
            
            result.push(current);
            return result;
        }
        
        // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –¥–ª—è —Ç—Ä–µ–∫–µ—Ä–∞
        async function loadTrackerData() {
            try {
                // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å—Ç–∞—Ç—É—Å—ñ–≤ –¥–ª—è —Ä–æ–∑–¥—ñ–ª—É 23
                const response23 = await fetch('https://docs.google.com/spreadsheets/d/e/2PACX-1vQgvcN2wNtjGNj7QZDdo7b5ZjzMusZLrET1ZxG25LZceqtClSGKhZhUiRfainsIfT85Gs5fVWsKFGLw/pub?gid=1281541325&single=true&output=csv');
                const text23 = await response23.text();
                const data23 = parseCSV(text23);
                
                // –û–±—Ä–æ–±–∫–∞ –¥–∞–Ω–∏—Ö –¥–ª—è —Ä–æ–∑–¥—ñ–ª—É 23
                statusData.chapter23.total = 0;
                statusData.chapter23.statuses = {
                    completed: 0,
                    partial: 0,
                    inprogress: 0,
                    notcompleted: 0,
                    notstarted: 0
                };
                
                data23.forEach(row => {
                    const status = row['–°—Ç–∞—Ç—É—Å'];
                    const count = parseInt(row['–ö—ñ–ª—å–∫—ñ—Å—Ç—å –∑–∞—Ö–æ–¥—ñ–≤']) || 0;
                    
                    if (status && count) {
                        statusData.chapter23.statuses[status] = count;
                        statusData.chapter23.total += count;
                    }
                });
                
                // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å—Ç–∞—Ç—É—Å—ñ–≤ –¥–ª—è —Ä–æ–∑–¥—ñ–ª—É 24
                const response24 = await fetch('https://docs.google.com/spreadsheets/d/e/2PACX-1vQgvcN2wNtjGNj7QZDdo7b5ZjzMusZLrET1ZxG25LZceqtClSGKhZhUiRfainsIfT85Gs5fVWsKFGLw/pub?gid=1141562032&single=true&output=csv');
                const text24 = await response24.text();
                const data24 = parseCSV(text24);
                
                // –û–±—Ä–æ–±–∫–∞ –¥–∞–Ω–∏—Ö –¥–ª—è —Ä–æ–∑–¥—ñ–ª—É 24
                statusData.chapter24.total = 0;
                statusData.chapter24.statuses = {
                    completed: 0,
                    partial: 0,
                    inprogress: 0,
                    notcompleted: 0,
                    notstarted: 0
                };
                
                data24.forEach(row => {
                    const status = row['–°—Ç–∞—Ç—É—Å'];
                    const count = parseInt(row['–ö—ñ–ª—å–∫—ñ—Å—Ç—å –∑–∞—Ö–æ–¥—ñ–≤']) || 0;
                    
                    if (status && count) {
                        statusData.chapter24.statuses[status] = count;
                        statusData.chapter24.total += count;
                    }
                });
                
                // –û–Ω–æ–≤–ª–µ–Ω–Ω—è –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—ó
                updateTrackerDisplay();
                
            } catch (error) {
                console.error('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö —Ç—Ä–µ–∫–µ—Ä–∞:', error);
            }
        }
        
        // –û–Ω–æ–≤–ª–µ–Ω–Ω—è –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—ó —Ç—Ä–µ–∫–µ—Ä–∞
        function updateTrackerDisplay() {
            // –û–Ω–æ–≤–ª–µ–Ω–Ω—è –¥–ª—è —Ä–æ–∑–¥—ñ–ª—É 23
            createStatusBar('23', statusData.chapter23);
            document.getElementById('chapter23-total').textContent = `–í—Å—å–æ–≥–æ –∑–∞—Ö–æ–¥—ñ–≤: ${statusData.chapter23.total}`;
            
            // –û–Ω–æ–≤–ª–µ–Ω–Ω—è –¥–ª—è —Ä–æ–∑–¥—ñ–ª—É 24
            createStatusBar('24', statusData.chapter24);
            document.getElementById('chapter24-total').textContent = `–í—Å—å–æ–≥–æ –∑–∞—Ö–æ–¥—ñ–≤: ${statusData.chapter24.total}`;
            
            // –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
            updateStatistics();
            
            // –û–Ω–æ–≤–ª–µ–Ω–Ω—è —á–∞—Å—É
            const now = new Date();
            document.getElementById('last-update').textContent = now.toLocaleString('uk-UA');
        }
        
        // –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å—Ç–∞—Ç—É—Å-–±–∞—Ä—É
        function createStatusBar(chapterId, data) {
            const statusBar = document.getElementById(`status-bar-${chapterId}`);
            statusBar.innerHTML = '';
            
            const total = data.total;
            if (total === 0) return;
            
            const statuses = [
                { key: 'completed', class: 'status-completed', label: '–í–∏–∫–æ–Ω–∞–Ω–æ' },
                { key: 'partial', class: 'status-partial', label: '–ß–∞—Å—Ç–∫–æ–≤–æ' },
                { key: 'inprogress', class: 'status-inprogress', label: '–í–∏–∫–æ–Ω—É—î—Ç—å—Å—è' },
                { key: 'notcompleted', class: 'status-notcompleted', label: '–ù–µ –≤–∏–∫–æ–Ω–∞–Ω–æ' },
                { key: 'notstarted', class: 'status-notstarted', label: '–ù–µ —Ä–æ–∑–ø–æ—á–∞—Ç–æ' }
            ];
            
            statuses.forEach(status => {
                const count = data.statuses[status.key];
                const percentage = (count / total * 100).toFixed(1);
                
                if (count > 0) {
                    const segment = document.createElement('div');
                    segment.className = `status-segment ${status.class}`;
                    segment.style.width = `${percentage}%`;
                    segment.innerHTML = `<span>${count}</span>`;
                    segment.title = `${status.label}: ${count} –∑–∞—Ö–æ–¥—ñ–≤ (${percentage}%)`;
                    statusBar.appendChild(segment);
                }
            });
        }
        
        // –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        function updateStatistics() {
            const total23 = statusData.chapter23.total;
            const total24 = statusData.chapter24.total;
            const totalMeasures = total23 + total24;
            
            const completed23 = statusData.chapter23.statuses.completed + statusData.chapter23.statuses.partial;
            const completed24 = statusData.chapter24.statuses.completed + statusData.chapter24.statuses.partial;
            const completedMeasures = completed23 + completed24;
            
            const active23 = statusData.chapter23.statuses.inprogress;
            const active24 = statusData.chapter24.statuses.inprogress;
            const activeMeasures = active23 + active24;
            
            const progressPercentage = totalMeasures > 0 
                ? ((completedMeasures / totalMeasures) * 100).toFixed(1) 
                : 0;
            
            document.getElementById('total-measures').textContent = totalMeasures;
            document.getElementById('completed-measures').textContent = completedMeasures;
            document.getElementById('progress-percentage').textContent = progressPercentage + '%';
            document.getElementById('active-measures').textContent = activeMeasures;
        }
        
        // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –¥–ª—è —Ç–∞–±–ª–∏—Ü—å
        async function loadTablesData() {
            try {
                // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –¥–ª—è —Ä–æ–∑–¥—ñ–ª—É 23
                const response23 = await fetch('https://docs.google.com/spreadsheets/d/e/2PACX-1vQgvcN2wNtjGNj7QZDdo7b5ZjzMusZLrET1ZxG25LZceqtClSGKhZhUiRfainsIfT85Gs5fVWsKFGLw/pub?gid=525968991&single=true&output=csv');
                const text23 = await response23.text();
                chapter23Data = parseCSV(text23);
                
                // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –¥–ª—è —Ä–æ–∑–¥—ñ–ª—É 24
                const response24 = await fetch('https://docs.google.com/spreadsheets/d/e/2PACX-1vQgvcN2wNtjGNj7QZDdo7b5ZjzMusZLrET1ZxG25LZceqtClSGKhZhUiRfainsIfT85Gs5fVWsKFGLw/pub?gid=1440097626&single=true&output=csv');
                const text24 = await response24.text();
                chapter24Data = parseCSV(text24);
                
                console.log('–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ –¥–∞–Ω–∏—Ö –¥–ª—è —Ä–æ–∑–¥—ñ–ª—É 23:', chapter23Data.length);
                console.log('–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ –¥–∞–Ω–∏—Ö –¥–ª—è —Ä–æ–∑–¥—ñ–ª—É 24:', chapter24Data.length);
                
            } catch (error) {
                console.error('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö —Ç–∞–±–ª–∏—Ü—å:', error);
            }
        }
        
        // –§—É–Ω–∫—Ü—ñ—è toggle –¥–ª—è —Ä–æ–∑–¥—ñ–ª—ñ–≤
        function toggleChapter(chapterNum) {
            const button = document.getElementById(`btn-chapter-${chapterNum}`);
            const table = document.getElementById(`table-chapter-${chapterNum}`);
            
            if (activeChapters.includes(chapterNum)) {
                // –ó–∞–∫—Ä–∏—Ç–∏ —Ä–æ–∑–¥—ñ–ª
                activeChapters = activeChapters.filter(ch => ch !== chapterNum);
                button.classList.remove('active');
                table.style.display = 'none';
            } else {
                // –í—ñ–¥–∫—Ä–∏—Ç–∏ —Ä–æ–∑–¥—ñ–ª
                activeChapters.push(chapterNum);
                activeChapters.sort();
                button.classList.add('active');
                table.style.display = 'block';
                renderTable(chapterNum);
            }
            
            // –ü–µ—Ä–µ–≤–ø–æ—Ä—è–¥–∫—É–≤–∞—Ç–∏ —Ç–∞–±–ª–∏—Ü—ñ (23 –∑–∞–≤–∂–¥–∏ –≤–∏—â–µ 24)
            const container23 = document.getElementById('table-chapter-23');
            const container24 = document.getElementById('table-chapter-24');
            
            if (activeChapters.includes(23) && activeChapters.includes(24)) {
                container23.parentNode.insertBefore(container23, container24);
            }
        }
        
        // –§—É–Ω–∫—Ü—ñ—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥—É —Ç–∞–±–ª–∏—Ü—ñ
        function renderTable(chapterNum) {
            const tbody = document.getElementById(`tbody-chapter-${chapterNum}`);
            const data = chapterNum === 23 ? chapter23Data : chapter24Data;
            tbody.innerHTML = '';
            
            let currentSR = '';
            let srRowspan = 0;
            let srRows = [];
            
            // –ì—Ä—É–ø—É–≤–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö –ø–æ –°–†
            const groupedData = {};
            data.forEach(row => {
                if (!row['–ö–æ–¥']) return;
                
                const code = row['–ö–æ–¥'];
                const parts = code.split('.');
                
                // –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è —Ç–∏–ø—É —Ä—è–¥–∫–∞
                if (parts[3] === '0' && parts[4] === '0' && parts[5] === '0') {
                    // –¶–µ —Ä–æ–∑–¥—ñ–ª –∞–±–æ –ø—ñ–¥—Ä–æ–∑–¥—ñ–ª
                    groupedData[code] = {
                        type: parts[2] === '0' ? 'section1' : (parts[1] !== '0' ? 'section2' : 'section3'),
                        name: row['–ù–∞–∑–≤–∞'],
                        measures: []
                    };
                } else if (parts[4] !== '0') {
                    // –¶–µ –∑–∞—Ö—ñ–¥
                    const srCode = `${parts[0]}.${parts[1]}.${parts[2]}.${parts[3]}`;
                    if (!groupedData[srCode]) {
                        groupedData[srCode] = {
                            type: 'sr',
                            name: '',
                            measures: []
                        };
                    }
                    
                    // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ñ—ñ–ª—å—Ç—Ä–∞ —Å—Ç–∞—Ç—É—Å—É
                    const status = row['–°—Ç–∞—Ç—É—Å'] || 'notstarted';
                    if (activeFilters.includes(status)) {
                        groupedData[srCode].measures.push(row);
                    }
                }
            });
            
            // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –∑–≥—Ä—É–ø–æ–≤–∞–Ω–∏—Ö –¥–∞–Ω–∏—Ö
            Object.keys(groupedData).sort().forEach(key => {
                const group = groupedData[key];
                
                if (group.type.startsWith('section')) {
                    // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –∑–∞–≥–æ–ª–æ–≤–∫–∞ —Ä–æ–∑–¥—ñ–ª—É
                    const tr = document.createElement('tr');
                    tr.className = `section-row-${group.type.charAt(7)}`;
                    
                    const td = document.createElement('td');
                    td.colSpan = 5;
                    td.textContent = `${key.replace(/\.0+$/, '').replace(/\.$/, '')}. ${group.name}`;
                    tr.appendChild(td);
                    
                    tbody.appendChild(tr);
                } else if (group.type === 'sr' && group.measures.length > 0) {
                    // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –∑–∞—Ö–æ–¥—ñ–≤ –¥–ª—è –°–†
                    group.measures.forEach((measure, index) => {
                        const tr = document.createElement('tr');
                        
                        // –ö–æ–ª–æ–Ω–∫–∞ ‚Ññ
                        const tdNum = document.createElement('td');
                        tdNum.className = 'col-number';
                        const parts = measure['–ö–æ–¥'].split('.');
                        tdNum.textContent = `${parts[3]}.${parts[4]}`;
                        tr.appendChild(tdNum);
                        
                        // –ö–æ–ª–æ–Ω–∫–∞ –°–† (—Ç—ñ–ª—å–∫–∏ –¥–ª—è –ø–µ—Ä—à–æ–≥–æ –∑–∞—Ö–æ–¥—É –≤ –≥—Ä—É–ø—ñ)
                        if (index === 0) {
                            const tdSR = document.createElement('td');
                            tdSR.className = 'col-sr';
                            tdSR.rowSpan = group.measures.length;
                            tdSR.textContent = key;
                            
                            // –ó–Ω–∞–π—Ç–∏ –Ω–∞–∑–≤—É –°–†
                            const srData = data.find(r => r['–ö–æ–¥'] === key + '.0.0');
                            if (srData) {
                                tdSR.innerHTML = `<div style="font-weight: 600; margin-bottom: 5px;">${key}</div>
                                                  <div style="font-size: 13px; color: #666;">${srData['–ù–∞–∑–≤–∞']}</div>`;
                            }
                            
                            tr.appendChild(tdSR);
                        }
                        
                        // –ö–æ–ª–æ–Ω–∫–∞ –ó–∞—Ö—ñ–¥
                        const tdMeasure = document.createElement('td');
                        tdMeasure.className = 'col-measure';
                        let measureCode = measure['–ö–æ–¥'].replace(/\.0$/, '');
                        if (parts[5] !== '0') {
                            measureCode = `${parts[0]}.${parts[1]}.${parts[2]}.${parts[3]}.${parts[4]} (${parts[5]})`;
                        }
                        tdMeasure.innerHTML = `<span class="measure-code">${measureCode}</span> ${measure['–ù–∞–∑–≤–∞']}`;
                        tr.appendChild(tdMeasure);
                        
                        // –ö–æ–ª–æ–Ω–∫–∞ –¢–µ—Ä–º—ñ–Ω
                        const tdDeadline = document.createElement('td');
                        tdDeadline.className = 'col-deadline';
                        tdDeadline.textContent = measure['–ü–µ—Ä—ñ–æ–¥'] || '-';
                        tr.appendChild(tdDeadline);
                        
                        // –ö–æ–ª–æ–Ω–∫–∞ –°—Ç–∞—Ç—É—Å
                        const tdStatus = document.createElement('td');
                        tdStatus.className = 'col-status';
                        const status = measure['–°—Ç–∞—Ç—É—Å'] || 'notstarted';
                        const statusIcon = getStatusIcon(status);
                        const statusLabel = getStatusLabel(status);
                        tdStatus.innerHTML = `
                            <div class="status-icon ${status}">${statusIcon}</div>
                            <div style="font-size: 12px;">${statusLabel}</div>
                        `;
                        tr.appendChild(tdStatus);
                        
                        tbody.appendChild(tr);
                    });
                }
            });
        }
        
        // –§—É–Ω–∫—Ü—ñ—ó –¥–ª—è —Å—Ç–∞—Ç—É—Å—ñ–≤
        function getStatusIcon(status) {
            const icons = {
                'completed': '‚úì',
                'partial': '‚óê',
                'inprogress': '‚è≥',
                'notcompleted': '‚úï',
                'notstarted': '‚óã'
            };
            return icons[status] || '‚óã';
        }
        
        function getStatusLabel(status) {
            const labels = {
                'completed': '–í–∏–∫–æ–Ω–∞–Ω–æ',
                'partial': '–ß–∞—Å—Ç–∫–æ–≤–æ',
                'inprogress': '–í–∏–∫–æ–Ω—É—î—Ç—å—Å—è',
                'notcompleted': '–ù–µ –≤–∏–∫–æ–Ω–∞–Ω–æ',
                'notstarted': '–ù–µ —Ä–æ–∑–ø–æ—á–∞—Ç–æ'
            };
            return labels[status] || '–ù–µ —Ä–æ–∑–ø–æ—á–∞—Ç–æ';
        }
        
        // –§—É–Ω–∫—Ü—ñ—ó —Ñ—ñ–ª—å—Ç—Ä–∞
        function toggleStatusFilter() {
            const dropdown = document.getElementById('status-filter-dropdown');
            dropdown.classList.toggle('show');
        }
        
        function toggleAllStatuses() {
            const allCheckbox = document.getElementById('filter-all');
            const checkboxes = ['completed', 'partial', 'inprogress', 'notcompleted', 'notstarted'];
            
            checkboxes.forEach(status => {
                document.getElementById(`filter-${status}`).checked = allCheckbox.checked;
            });
            
            if (allCheckbox.checked) {
                activeFilters = [...checkboxes];
            } else {
                activeFilters = [];
            }
            
            updateFilterText();
            rerenderActiveTables();
        }
        
        function updateFilter() {
            const checkboxes = ['completed', 'partial', 'inprogress', 'notcompleted', 'notstarted'];
            activeFilters = checkboxes.filter(status => 
                document.getElementById(`filter-${status}`).checked
            );
            
            // –û–Ω–æ–≤–∏—Ç–∏ —á–µ–∫–±–æ–∫—Å "–í—Å—ñ —Å—Ç–∞—Ç—É—Å–∏"
            document.getElementById('filter-all').checked = activeFilters.length === checkboxes.length;
            
            updateFilterText();
            rerenderActiveTables();
        }
        
        function updateFilterText() {
            const filterText = document.getElementById('filter-text');
            if (activeFilters.length === 5) {
                filterText.textContent = '–í—Å—ñ —Å—Ç–∞—Ç—É—Å–∏';
            } else if (activeFilters.length === 0) {
                filterText.textContent = '–ù–µ–º–∞—î –≤–∏–±—Ä–∞–Ω–∏—Ö';
            } else {
                filterText.textContent = `–í–∏–±—Ä–∞–Ω–æ: ${activeFilters.length}`;
            }
        }
        
        function rerenderActiveTables() {
            activeChapters.forEach(chapter => {
                renderTable(chapter);
            });
        }
        
        // –ó–∞–∫—Ä–∏—Ç—Ç—è dropdown –ø—Ä–∏ –∫–ª—ñ–∫—É –ø–æ–∑–∞ –Ω–∏–º
        document.addEventListener('click', function(event) {
            const dropdown = document.getElementById('status-filter-dropdown');
            const button = document.querySelector('.status-filter-button');
            
            if (!dropdown.contains(event.target) && !button.contains(event.target)) {
                dropdown.classList.remove('show');
            }
        });
        
        // –ì–æ–ª–æ–≤–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
        async function loadAllData() {
            const refreshIcon = document.getElementById('refresh-icon');
            refreshIcon.style.animation = 'spin 1s linear infinite';
            
            try {
                await Promise.all([
                    loadTrackerData(),
                    loadTablesData()
                ]);
            } finally {
                refreshIcon.style.animation = '';
            }
        }
        
        // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏
        document.addEventListener('DOMContentLoaded', function() {
            loadAllData();
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –∫–æ–∂–Ω—ñ 5 —Ö–≤–∏–ª–∏–Ω
            setInterval(loadAllData, 300000);
        });
    </script>
</body>
</html>
